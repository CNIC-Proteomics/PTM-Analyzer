# PTM-Analyzer Pipeline

The **PTM-Analyzer** pipeline enables statistical analysis and quantitative data exploration for the outputs generated by iSanXoT. It consists of four modules: *MergeiSanxotPGM*, *NMpyCompare*, *ReportLimma*, *FDRoptimizer*, and *qTableReport*. Each module is implemented as either a Python or R script and is executed using a configuration file.


# Installation

## Download the last release

+ Download the PTM-Analyzer-vx.xx.zip from the last release and unzip the file:
https://github.com/CNIC-Proteomics/PTM-Analyzer/releases

or

+ Clone the repository using the last release tag:

```bash
git clone https://github.com/CNIC-Proteomics/PTM-Analyzer.git --branch {LAST_RELEASE_TAG}
```

## Install Python and R

Ensure Python and R are installed on your system along with the required dependencies.

For further information, consult the [INSTALLATION Guide](INSTALLATION.md).


# Modules

## 1. MergeiSanxotPGM
This Python script merges the iSanXoT report of protein2proteinall with the PDM table at PGM level.

## 2. NMpyCompare
This Python script calculates NM-corrected values from the iSanXoT report. It subtracts the Zpgm2p value of the associated non-modified peptidoform from the Zpgm2p value of each modified peptidoform. Users can specify column names for integration levels, quantitative values, and criteria for identifying non-modified peptidoforms through the configuration file. The NM-corrected values are then appended as new columns in the iSanXoT report.

## 3. ReportLimma
This script performs hypothesis testing for comparisons between different groups across integration levels using the **limma** package. It computes p-values for statistical contrasts, the mean difference between groups, and the LPS value (-log(p-value) adjusted by the sign of the mean difference).

## 4. FDRoptimizer
Implemented in Python, this script applies an iterative algorithm to optimize the spectral count threshold at each integration step. It scans different thresholds to maximize the number of elements with a q-value below a user-defined threshold, using the Benjamini-Hochberg algorithm for multiple testing correction.

## 5. PTMMap
PTMap is a tool developed with the aim of visualizing, interpreting, and comparing the proteins PTMs of s. This module represents, as many maps as proteins for which any integration meets the threshold established by the user. Each map illustrates the change between one condition and another based on the p-value of all calculated integrations, on the y-axis.

## 6. qTableReport
This Python script enables a detailed exploration of significant changes at the protein level in a peptide-centric workflow. It generates an output table summarizing the number of modified and non-modified peptidoforms with significant increases or decreases, along with details on digestion status and qc clusters.

For further information, consult the [MODULES Documentation](MODULES.md).

# Example Commands

For additional examples and tests, please consult the [TESTS Guide](TESTS.md).


# Contact
For questions or issues, please open an issue on the GitHub repository.

